---
title: "Intrepid-2a replication analyses"
author: "Marius 't Hart"
date: "2025-04-09"
output:
  word_document: default
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Overview

The Intrepid consortium aims to compare three computational theories of consciousness by testing their predictions on spatial perception in inactivated areas of cortex. In the Intrepid-2a project, there are 3 psychophysics experiments testing spatial perception around the blind spot. In Toronto we are replicating the work from the primary lab in Glasgow. This consists of three psychophysics tasks that we analyse here.

An overview of the full Intrepid project can be found here: [https://osf.io/4rn85](https://osf.io/4rn85).

Tasks:

- area perception: matching task; a circle around the fovea has to matched in size to a peripheral circle which is either around the blind spot, or at a different area of the retina
- curvature perception: staircase task; participants reply whether an apparent motion path is curved to the left or to the right, the paths are either right next to the blind spot or away from the blind spot
- distance perception: staircase task; participants reply which of two dot pairs is further from each other, either one of the dot pairs spans the blind spot, or neither do

# Setup Code

First we load all the scripts to do the analyses:

```{r}
# this script has function to download the data:
source("R/data.R")
# this script contains generic utility functions:
source("R/utilities.R")
# script with custom psychometric functions:
source("R/mprobit.R")

# this script contains functions to process the distance task data:
source('R/distance2.R')
# this script contains functions to process the curvature task data:
source('R/curvature.R')
# this script contains functions to process the area task data:
source("R/area.R")
# alternative just using a gaussian density distribution:
source("R/area2.R")

# scripts testing relations between effects in distance and curvature task:
source("R/dist_curve.R")
```

# Download Data

We download the data from a (private) OSF repository:

```{r eval=F}
getData()
```

# Area task

A first peek at the data, plotted as an emprirical cumulative distribution, fitted with a probit function:

```{r fig.width=6.5, fig.height=5}
plotAreaPsychometricCurve()
```

And here is an alternative, just plotting a density distribution:

```{r fig.width=6.5, fig.height=5}
plotAreaDensityCurve()
```

Statistics. Not expecting any effects.

We fit a probit function to each participants data in the 4 conditions, to determine the PSE/mean as well as the slope/sd, and can then do two repeated-measures ANOVA using eye (ipsi/contra) and location (across/away) as factors. One ANOVA on the PSE, and one on the slope.


```{r}
doAreaStats()
```

Indeed nothing is significant.

# Curvature task

Let's look at the data:

```{r fig.width=6.5, fig.height=5}
plotCurvaturePsychometricCurve()
```

Perhaps there is a small effect of whether the stimulus was presented close to the blind spot or away from it. We repeat the same ANOVA procedure as above.

```{r}
doCurvatureStats()
```


# Distance task

First, we look at the data:

```{r fig.width=6.5, fig.height=5}
plotDistancePsychometricCurve()
```

We can see differences in the bias, and perhaps in the slope. To test this statistically, we will again fit probit functions to each participants' data (all 4 conditions), and use the factors eye (ipsi/contra) and location (across/away) in two repeated measures ANOVA's: one for each parameter (bias and slope).

```{r}
doDistanceStats()
```

# Effect strength across participants

Finally, we do a cursory check to see if participants with a large effect in the distance perception task also have a large effect in the curvature task. We do this by plotting the difference between the two conditions (at blind spot / away from blind spot) in the ipsi-lateral eye only for each participant in both tasks.

```{r fig.width=7, fig.height=5}
plotEffectStrength()
```

That doesn't look like much. Here is a regression on this data:

```{r}
regressionEffectStrength()
```

The NHST regression fails to reject the null hypothesis. The Bayesian linear model does not show evidence for the null hypothesis either.

## Save figures as files

Each figure can be saved in various formats, for now, we just do PDFs.

```{r}

for (target in c('pdf', 'svg')) {
  plotAreaPsychometricCurve(target=target)
  plotAreaDensityCurve(target=target)
  plotCurvaturePsychometricCurve(target=target)
  plotDistancePsychometricCurve(target=target)
}

```

